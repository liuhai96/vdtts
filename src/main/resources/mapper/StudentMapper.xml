<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lsjbc.vdtts.dao.mapper.StudentMapper">
<!--    查询所属驾校中的学员-->
<!--    <select id="selectAdminInfo" resultType="com.sharefile.db.TbAdmin" parameterType="com.lsjbc.vdtts.entity.Teacher">-->
<!--        select admin_name as adminName,admin_pwd as adminPwd from tb_admin where admin_name =#{adminName}-->
<!--         and admin_pwd =#{adminPwd}-->
<!--    </select>-->

    <select id="selectAllInfo" resultType="com.lsjbc.vdtts.entity.Student"  parameterType="com.lsjbc.vdtts.entity.Student">
        select * from tb_student
        <where>
            <if test="student.studentName!=null and tba.studentName!=''">
                and s_name like CONCAT('%', #{student.studentName} ,'%')
            </if>
        </where>
        limit #{page},#{limit}
    </select>

    <select id="selectCount" resultType="int"  parameterType="com.lsjbc.vdtts.entity.Student">
        select count(*) from tb_student
        <where>
            <if test="student.studentName!=null and tba.studentName!=''">
                and s_name like CONCAT('%', #{student.studentName} ,'%')
            </if>
        </where>
    </select>

    <insert id="insertstudent"  parameterType="com.lsjbc.vdtts.entity.Student">
         insert into tb_student(s_name,s_pwd,s_id) values (#{sName},#{sPwd},#{sId})
   </insert>

    <insert id="updatestudent"  parameterType="com.lsjbc.vdtts.entity.Student">
         update tb_student set s_name=#{sName},s_pwd=#{sPwd},role_id=#{roleId} where s_id =#{sId}
   </insert>

    <delete id="deletestudent"  parameterType="com.lsjbc.vdtts.entity.Student">
        delete from tb_student where s_id =#{sId}
    </delete>


<!--  陈竑霖-->
<!--表单-->
    <select id="selectList" resultType="com.lsjbc.vdtts.entity.Student">
         select stu.s_id,sch.s_name schoolName,stu.s_sfz,stu.s_name,stu.s_sex,stu.s_birthday,stu.s_reg_time,stu.s_license_time,tea.t_name teacherName
         from tb_student stu,tb_school sch,tb_teacher tea where stu.s_school_id=sch.s_id and stu.s_teacher_id=tea.t_id

            <if test="e.sName!=null and e.sName!=''"> and stu.s_name like concat('%',#{e.sName},'%')</if>
<!--             <if test="e.sSex!=null and e.sSex!=''"> and stu.s_sex like concat('%',#{e.sSex},'%')</if>-->
            <if test="e.sLicenseTime!=null and e.sLicenseTime!=''"> and stu.s_license_time like concat('%',#{e.sLicenseTime},'%')</if>

        limit #{start},#{pageSize}
    </select>
<!--分页-->
    <select id="selectListCount" resultType="int" parameterType="com.lsjbc.vdtts.entity.Student">
        select count(s_id) from tb_student
        <!--where自动帮我们取消掉多余的and或or-->
        <where>
            <if test="e.sName!=null and e.sName!=''"> and s_name like concat('%',#{e.sName},'%')</if>
<!--            <if test="e.sSex!=null and e.sSex!=''"> and s_sex like concat('%',#{e.sSex},'%')</if>-->
            <if test="e.sLicenseTime!=null and e.sLicenseTime!=''"> and s_license_time like concat('%',#{e.sLicenseTime},'%')</if>
        </where>
    </select>

    <insert id="addStudentMessage" parameterType="com.lsjbc.vdtts.entity.Student" keyProperty="sId" useGeneratedKeys="true">
        insert into tb_student (s_account_id, s_school_id, s_sfz, s_name, s_phone, s_sex, s_birthday, s_pic, s_reg_time, s_license_time, s_teacher_id)
        values (#{sAccountId},#{sSchooleId},#{sSfz},#{sName},#{sPhone},#{sSex},#{sBirthday},#{sPic},#{sRegTime},#{sLicenseTime},#{sTeacherId})
    </insert><!--  李浪  -->
</mapper>